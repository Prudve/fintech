<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Merchant Shield | Andhra Kings</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&family=JetBrains+Mono:wght@400;700&family=Nunito:wght@700;900&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Inter', sans-serif; }
        .font-code { font-family: 'JetBrains Mono', monospace; }
        
        /* NEW FONT SETTING: CURVY & BOLDER */
        .font-nums { font-family: 'Nunito', sans-serif; font-weight: 900; letter-spacing: 0.02em; }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #0f172a; }
        ::-webkit-scrollbar-thumb { background: #334155; border-radius: 4px; }
        
        /* Animations */
        .fade-in { animation: fadeIn 0.6s cubic-bezier(0.16, 1, 0.3, 1); }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        
        /* Glow Effects */
        .cyber-glow { box-shadow: 0 0 15px rgba(6, 182, 212, 0.3); }
        .gold-glow { text-shadow: 0 0 10px rgba(234, 179, 8, 0.3); }
    </style>
</head>
<body class="bg-[#0B1120] text-slate-200 min-h-screen p-6 md:p-10 selection:bg-cyan-500/30">

    <div class="max-w-7xl mx-auto space-y-8">
        
        <div class="flex flex-col md:flex-row justify-between items-end border-b border-slate-800 pb-6 fade-in">
            <div class="flex items-center gap-5">
                
                <div class="relative group">
                    <div class="absolute -inset-1 bg-gradient-to-r from-cyan-400 to-blue-600 rounded-xl blur opacity-20 group-hover:opacity-40 transition duration-500"></div>
                    <div class="relative bg-slate-900 border border-slate-700 p-4 rounded-xl cyber-glow">
                        <i class="fas fa-fingerprint text-3xl text-cyan-400"></i>
                    </div>
                </div>

                <div>
                    <h1 class="text-3xl md:text-4xl font-black text-white tracking-tighter leading-none">
                        MERCHANT SHIELD <span class="text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 to-blue-500">PRO</span>
                    </h1>
                    
                    <div class="mt-2 flex items-center gap-3">
                        <div class="flex items-center gap-2 px-3 py-1 rounded-full border border-yellow-500/20 bg-yellow-500/5 backdrop-blur-sm">
                            <i class="fas fa-crown text-[10px] text-yellow-500"></i>
                            <span class="text-[10px] font-code font-bold tracking-[0.15em] uppercase text-transparent bg-clip-text bg-gradient-to-r from-yellow-400 via-orange-400 to-yellow-400 gold-glow">
                                Designed by Andhra Kings
                            </span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="mt-6 md:mt-0 text-right">
                <div class="flex items-center justify-end gap-2 text-xs font-code text-slate-500 mb-1">
                    <i class="fas fa-network-wired"></i> API GATEWAY
                </div>
                <div class="flex items-center justify-end gap-2 text-emerald-400 font-bold text-sm tracking-wide bg-emerald-500/10 px-3 py-1 rounded-md border border-emerald-500/20 font-nums">
                    <span class="relative flex h-2 w-2">
                      <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-400 opacity-75"></span>
                      <span class="relative inline-flex rounded-full h-2 w-2 bg-emerald-500"></span>
                    </span>
                    SYSTEM ONLINE
                </div>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-12 gap-8 fade-in" style="animation-delay: 0.1s;">
            
            <div class="lg:col-span-4 space-y-6">
                
                <div class="bg-slate-900/50 rounded-2xl p-6 border border-slate-800 shadow-2xl backdrop-blur-sm">
                    <h3 class="text-sm font-bold text-slate-400 mb-6 flex items-center gap-2 uppercase tracking-widest">
                        <i class="fas fa-search-dollar text-cyan-500"></i> Transaction Data
                    </h3>
                    
                    <div class="space-y-5">
                        <div>
                            <label class="text-[10px] font-bold text-slate-500 uppercase ml-1 mb-1 block">Transaction ID</label>
                            <input type="text" id="tx_id" placeholder="Auto-Generated" 
                                class="w-full bg-[#0F1623] border border-slate-700 text-slate-200 text-sm rounded-lg p-3 focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 outline-none font-nums transition-all placeholder-slate-600">
                        </div>

                        <div class="grid grid-cols-5 gap-3">
                            <div class="col-span-2">
                                <label class="text-[10px] font-bold text-slate-500 uppercase ml-1 mb-1 block">Currency</label>
                                <div class="relative">
                                    <select id="curr" class="w-full appearance-none bg-[#0F1623] border border-slate-700 text-slate-200 text-sm rounded-lg p-3 focus:ring-2 focus:ring-cyan-500 outline-none font-nums">
                                        <option value="USD">USD $</option>
                                        <option value="INR">INR ₹</option>
                                        <option value="EUR">EUR €</option>
                                    </select>
                                    <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-slate-500">
                                        <i class="fas fa-chevron-down text-xs"></i>
                                    </div>
                                </div>
                            </div>
                            <div class="col-span-3">
                                <label class="text-[10px] font-bold text-slate-500 uppercase ml-1 mb-1 block">Amount</label>
                                <input type="number" id="amt" placeholder="0.00" 
                                    class="w-full bg-[#0F1623] border border-slate-700 text-white text-sm rounded-lg p-3 focus:ring-2 focus:ring-cyan-500 outline-none font-nums">
                            </div>
                        </div>

                        <button onclick="runScan()" 
                            class="group w-full bg-gradient-to-r from-cyan-600 to-blue-600 hover:from-cyan-500 hover:to-blue-500 text-white font-bold py-4 rounded-xl shadow-lg shadow-cyan-900/20 transition-all active:scale-[0.98] flex justify-center items-center gap-3 border border-white/10">
                            <span>INITIATE SCAN</span>
                            <i class="fas fa-radar group-hover:rotate-12 transition-transform"></i>
                        </button>
                    </div>
                </div>

                <div id="resultCard" class="hidden bg-slate-900 p-8 rounded-2xl border border-slate-800 text-center shadow-2xl relative overflow-hidden">
                    <div class="absolute inset-0 bg-grid-slate-800/[0.2] bg-[length:20px_20px]"></div>
                    <div class="relative z-10">
                        <p class="text-[10px] font-bold text-slate-500 uppercase tracking-[0.3em] mb-4">Risk Probability Score</p>
                        
                        <h2 id="scoreDisplay" class="text-6xl text-white mb-2 tracking-tight font-nums">0%</h2>
                        
                        <div class="mt-4 mb-6">
                            <span id="badge" class="px-4 py-1.5 rounded text-[10px] font-black text-white uppercase tracking-widest border border-white/10">Analyzing...</span>
                        </div>

                        <div class="bg-slate-950/50 rounded-lg p-3 border border-slate-800">
                            <p id="normalizationMsg" class="font-nums text-[10px] text-slate-400">Waiting for data stream...</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="lg:col-span-8">
                <div class="bg-slate-900/50 rounded-2xl border border-slate-800 shadow-2xl h-full flex flex-col backdrop-blur-sm">
                    <div class="p-5 border-b border-slate-800 flex justify-between items-center bg-slate-900/80 rounded-t-2xl">
                        <h3 class="font-bold text-slate-200 flex items-center gap-2 text-sm uppercase tracking-wide">
                            <i class="fas fa-history text-slate-500"></i> Audit Log
                        </h3>
                        <button onclick="clearLog()" class="text-[10px] font-bold text-red-500 hover:text-red-400 transition-colors uppercase tracking-wider flex items-center gap-2 bg-red-500/10 px-3 py-1 rounded-md border border-red-500/20">
                            <i class="fas fa-eraser"></i> Clear
                        </button>
                    </div>

                    <div class="flex-grow overflow-auto relative min-h-[400px]">
                        <table class="w-full text-left">
                            <thead class="bg-slate-950 text-[10px] uppercase text-slate-500 font-bold sticky top-0 z-20">
                                <tr>
                                    <th class="p-4 bg-slate-950">Time</th>
                                    <th class="p-4 bg-slate-950">TX ID</th>
                                    <th class="p-4 bg-slate-950">Input</th>
                                    <th class="p-4 bg-slate-950 text-cyan-500">USD Value</th>
                                    <th class="p-4 bg-slate-950 text-right">Score</th>
                                </tr>
                            </thead>
                            <tbody id="logBody" class="text-sm divide-y divide-slate-800/50">
                                </tbody>
                        </table>

                        <div id="emptyState" class="absolute inset-0 flex flex-col items-center justify-center text-slate-600 pointer-events-none opacity-50">
                            <i class="fas fa-terminal text-5xl mb-4"></i>
                            <p class="text-xs font-code uppercase tracking-widest">Awaiting Transactions...</p>
                        </div>
                    </div>
                    
                    <div class="p-2 bg-slate-950 border-t border-slate-800 text-center">
                        <p class="text-[10px] text-slate-600 font-code">SECURED BY LOGISTIC REGRESSION // V1.0</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        async function runScan() {
            const txInput = document.getElementById('tx_id');
            const currInput = document.getElementById('curr');
            const amtInput = document.getElementById('amt');
            
            const txValue = txInput.value || "TXN-" + Math.floor(10000 + Math.random() * 90000);
            
            if (!amtInput.value) { 
                amtInput.classList.add('ring-2', 'ring-red-500');
                setTimeout(() => amtInput.classList.remove('ring-2', 'ring-red-500'), 500);
                return; 
            }

            try {
                const response = await fetch('http://127.0.0.1:5000/analyze-risk', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        "tx_id": txValue,
                        "currency": currInput.value,
                        "amount": amtInput.value
                    })
                });

                if (!response.ok) throw new Error("API Connection Failed");

                const data = await response.json();
                const score = (data.fraud_probability * 100).toFixed(2);

                const card = document.getElementById('resultCard');
                const badge = document.getElementById('badge');
                const normMsg = document.getElementById('normalizationMsg');
                const scoreDisplay = document.getElementById('scoreDisplay');
                
                card.classList.remove('hidden');
                scoreDisplay.innerText = score + "%";
                
                normMsg.innerHTML = `<span class="text-slate-500 font-sans">NORMALIZE:</span> <span class="text-slate-200 font-nums">${data.currency} ${data.original_amount}</span> <i class="fas fa-arrow-right mx-1 text-slate-600"></i> <span class="text-cyan-400 font-bold font-nums">$${data.normalized_usd}</span>`;

                if (data.fraud_probability > 0.5) {
                    card.className = "bg-slate-900 p-8 rounded-2xl border border-red-500/50 shadow-[0_0_40px_rgba(220,38,38,0.2)] text-center relative overflow-hidden";
                    badge.className = "px-6 py-2 rounded-full text-[10px] font-black text-white bg-red-600 shadow-lg shadow-red-500/30 uppercase tracking-widest";
                    badge.innerHTML = "<i class='fas fa-shield-virus mr-2'></i> THREAT DETECTED";
                    scoreDisplay.className = "text-6xl text-red-500 mb-2 tracking-tight drop-shadow-lg font-nums";
                } else {
                    card.className = "bg-slate-900 p-8 rounded-2xl border border-emerald-500/50 shadow-[0_0_40px_rgba(16,185,129,0.2)] text-center relative overflow-hidden";
                    badge.className = "px-6 py-2 rounded-full text-[10px] font-black text-white bg-emerald-600 shadow-lg shadow-emerald-500/30 uppercase tracking-widest";
                    badge.innerHTML = "<i class='fas fa-shield-check mr-2'></i> VERIFIED SAFE";
                    scoreDisplay.className = "text-6xl text-emerald-400 mb-2 tracking-tight drop-shadow-lg font-nums";
                }

                document.getElementById('emptyState').style.display = 'none';
                const logBody = document.getElementById('logBody');
                const row = logBody.insertRow(0);
                
                row.className = "hover:bg-slate-800/50 transition-colors border-b border-slate-800/50 group animate-[fadeIn_0.3s_ease-out]";
                
                row.innerHTML = `
                    <td class="p-4 text-slate-500 font-nums text-xs group-hover:text-slate-300">${data.time}</td>
                    <td class="p-4 font-bold text-slate-200 font-nums text-xs">${data.tx_id}</td>
                    <td class="p-4 font-nums text-slate-400 text-xs">${data.currency} ${data.original_amount}</td>
                    <td class="p-4 text-cyan-500 font-bold font-nums text-xs">$${data.normalized_usd}</td>
                    <td class="p-4 text-right">
                        <span class="${data.fraud_probability > 0.5 ? 'text-red-500' : 'text-emerald-500'} font-black text-sm font-nums">${score}%</span>
                    </td>
                `;

            } catch (error) {
                console.error(error);
                alert("Connection Error. Ensure python app.py is running.");
            }
        }

        function clearLog() {
            document.getElementById('logBody').innerHTML = '';
            document.getElementById('emptyState').style.display = 'flex';
        }
    </script>
</body>
</html>